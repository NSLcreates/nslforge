<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sealed Brew | Official Archive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,700;0,900;1,700;1,900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #FDFCF8;
            --accent-peach: #FFD8CC;
            --text-dark: #2D2D2D;
            --coffee-foam: #F5F0E6;
        }
        body { background-color: var(--bg-main); color: var(--text-dark); font-family: 'Plus Jakarta Sans', sans-serif; }
        h1, h2, h3, .brand-font { font-family: 'Playfair Display', serif; }
        
        .soft-card { background: white; border: 1px solid rgba(0,0,0,0.05); box-shadow: 0 20px 40px rgba(0,0,0,0.03); }
        .btn-pastel { background: var(--text-dark); color: white; font-weight: 800; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 0.1em; }
        .btn-pastel:hover:not(:disabled) { background: var(--accent-peach); color: var(--text-dark); }
        
        #auth-modal { position: fixed; inset: 0; background: rgba(255,255,255,0.85); backdrop-filter: blur(12px); z-index: 2000; display: none; align-items: center; justify-content: center; }
        .pill-card { border-radius: 40px; padding: 1.5rem; background: white; border: 1px solid rgba(0,0,0,0.04); text-align: center; }
        .pill-img { width: 100%; aspect-ratio: 1/1; border-radius: 30px; object-fit: cover; margin-bottom: 1rem; background: var(--coffee-foam); }
        
        #cart-panel { position: fixed; top: 0; right: 0; h: 100%; width: 100%; max-width: 400px; background: white; z-index: 2100; transform: translateX(100%); transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: -10px 0 30px rgba(0,0,0,0.05); }
    </style>
</head>
<body>

    <!-- AUTH MODAL -->
    <div id="auth-modal">
        <div class="max-w-md w-full p-10 soft-card rounded-[3rem]">
            <div class="flex justify-between mb-8">
                <h2 id="auth-title" class="text-2xl font-black brand-font uppercase">Member Login</h2>
                <button onclick="document.getElementById('auth-modal').style.display='none'"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <form id="auth-form" class="space-y-4">
                <div id="signup-fields" class="hidden">
                    <input type="text" id="auth-name" placeholder="FULL NAME" class="w-full p-4 rounded-full border border-zinc-100 outline-none text-xs font-bold">
                </div>
                <input type="email" id="auth-email" placeholder="EMAIL" required class="w-full p-4 rounded-full border border-zinc-100 outline-none text-xs font-bold">
                <input type="password" id="auth-password" placeholder="PASSWORD" required class="w-full p-4 rounded-full border border-zinc-100 outline-none text-xs font-bold">
                <button type="submit" class="btn-pastel w-full py-5 rounded-full text-xs mt-4">Continue</button>
            </form>
            <button onclick="toggleAuth()" id="auth-toggle-btn" class="w-full text-center mt-6 text-[10px] font-black text-zinc-400 uppercase tracking-widest">
                Create an account
            </button>
        </div>
    </div>

    <!-- HEADER -->
    <header class="fixed top-0 w-full z-50 p-8 flex justify-between items-center bg-white/50 backdrop-blur-md">
        <div class="text-2xl font-black brand-font"><span style="color: #E68A5E">SEALED</span>BREW</div>
        <div class="flex gap-6 items-center">
            <button id="user-btn" class="flex items-center gap-2">
                <i class="fa-solid fa-user-circle text-2xl"></i>
                <span id="user-label" class="text-[10px] font-black uppercase">Login</span>
            </button>
            <button id="cart-btn" class="relative">
                <i class="fa-solid fa-bag-shopping text-2xl"></i>
                <span id="cart-count" class="absolute -top-2 -right-2 bg-black text-white text-[9px] w-5 h-5 flex items-center justify-center rounded-full">0</span>
            </button>
        </div>
    </header>

    <main class="pt-40 px-8 max-w-7xl mx-auto pb-20">
        <div class="mb-16">
            <h1 class="text-7xl font-black brand-font leading-tight mb-4">THE<br><span style="color: #E68A5E">PASTEL</span><br>ARCHIVE</h1>
            <p class="text-xs font-bold uppercase tracking-[0.3em] text-zinc-400">Exclusive Coffee Blends</p>
        </div>

        <div id="product-grid" class="grid grid-cols-1 md:grid-cols-3 gap-10">
            <!-- Products injected here -->
        </div>
    </main>

    <!-- CART PANEL -->
    <aside id="cart-panel" class="flex flex-col">
        <div class="p-8 border-b flex justify-between items-center">
            <h2 class="text-xl font-black brand-font uppercase">Your Bag</h2>
            <button onclick="document.getElementById('cart-panel').style.transform='translateX(100%)'"><i class="fa-solid fa-xmark text-xl"></i></button>
        </div>
        <div id="cart-items" class="p-8 flex-grow overflow-y-auto space-y-4"></div>
        <div class="p-8 bg-zinc-50 border-t">
            <div class="flex justify-between mb-4">
                <span class="text-[10px] font-black uppercase text-zinc-400">Total Amount</span>
                <span id="cart-total" class="font-black text-xl">₹0</span>
            </div>
            <button id="checkout-btn" class="w-full btn-pastel py-6 rounded-full text-xs">Confirm Order</button>
        </div>
    </aside>

    <!-- FIREBASE SYSTEM -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Your exact Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyAU1yekU2rDq5hZZN9Xlu1HzWx6BXlhesI",
            authDomain: "sealed-brew.firebaseapp.com",
            projectId: "sealed-brew",
            storageBucket: "sealed-brew.firebasestorage.app",
            messagingSenderId: "917026506534",
            appId: "1:917026506534:web:adc1b9fe58ec041a03e3e7",
            measurementId: "G-82ZXFL83H3"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let cart = [];
        let isSignup = false;

        const products = [
            { id: 1, name: "Velvet Caramel", price: 225, img: "https://images.unsplash.com/photo-1559056199-641a0ac8b55e?q=80&w=500&auto=format&fit=crop" },
            { id: 2, name: "Peach Infusion", price: 205, img: "https://images.unsplash.com/photo-1544413647-b5104914d3db?q=80&w=500&auto=format&fit=crop" },
            { id: 3, name: "Minted Mocha", price: 189, img: "https://images.unsplash.com/photo-1572442388796-11668a67e53d?q=80&w=500&auto=format&fit=crop" }
        ];

        // Auth Functions
        window.toggleAuth = () => {
            isSignup = !isSignup;
            document.getElementById('auth-title').innerText = isSignup ? 'Sign Up' : 'Member Login';
            document.getElementById('signup-fields').classList.toggle('hidden', !isSignup);
            document.getElementById('auth-toggle-btn').innerText = isSignup ? 'Already have an account? Login' : 'Create an account';
        };

        document.getElementById('auth-form').onsubmit = async (e) => {
            e.preventDefault();
            const email = document.getElementById('auth-email').value;
            const pass = document.getElementById('auth-password').value;
            try {
                if (isSignup) {
                    const res = await createUserWithEmailAndPassword(auth, email, pass);
                    await setDoc(doc(db, "users", res.user.uid), { email, name: document.getElementById('auth-name').value });
                } else {
                    await signInWithEmailAndPassword(auth, email, pass);
                }
                document.getElementById('auth-modal').style.display = 'none';
            } catch (err) { alert(err.message); }
        };

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            document.getElementById('user-label').innerText = user ? 'Account' : 'Login';
            if (user) {
                // Listen to Cloud Cart
                onSnapshot(doc(db, "carts", user.uid), (snap) => {
                    if (snap.exists()) { cart = snap.data().items || []; renderCart(); }
                });
            } else {
                cart = []; renderCart();
            }
        });

        document.getElementById('user-btn').onclick = () => {
            if (currentUser) { if(confirm("Sign out?")) signOut(auth); }
            else { document.getElementById('auth-modal').style.display = 'flex'; }
        };

        // Cart Logic
        window.addToCart = async (id) => {
            if (!currentUser) { document.getElementById('auth-modal').style.display = 'flex'; return; }
            const p = products.find(x => x.id === id);
            const item = cart.find(x => x.id === id);
            if (item) item.qty++; else cart.push({ ...p, qty: 1 });
            await setDoc(doc(db, "carts", currentUser.uid), { items: cart });
        };

        window.updateQty = async (id, delta) => {
            const item = cart.find(x => x.id === id);
            if (item) {
                item.qty += delta;
                if (item.qty <= 0) cart = cart.filter(x => x.id !== id);
                await setDoc(doc(db, "carts", currentUser.uid), { items: cart });
            }
        };

        function renderCart() {
            const container = document.getElementById('cart-items');
            const total = cart.reduce((s, i) => s + (i.price * i.qty), 0);
            const count = cart.reduce((s, i) => s + i.qty, 0);

            document.getElementById('cart-count').innerText = count;
            document.getElementById('cart-total').innerText = `₹${total}`;
            
            container.innerHTML = cart.length === 0 ? '<p class="text-center text-zinc-300 py-10 uppercase text-[10px] font-black">Bag is empty</p>' : 
            cart.map(i => `
                <div class="flex items-center gap-4 bg-zinc-50 p-4 rounded-3xl">
                    <img src="${i.img}" class="w-12 h-12 rounded-xl object-cover">
                    <div class="flex-grow font-black text-[10px] uppercase">${i.name}</div>
                    <div class="flex items-center gap-3">
                        <button onclick="updateQty(${i.id}, -1)" class="w-6 h-6 rounded-full bg-white border border-zinc-200">-</button>
                        <span class="text-xs font-black">${i.qty}</span>
                        <button onclick="updateQty(${i.id}, 1)" class="w-6 h-6 rounded-full bg-white border border-zinc-200">+</button>
                    </div>
                </div>
            `).join('');
        }

        // Shop UI
        function renderShop() {
            document.getElementById('product-grid').innerHTML = products.map(p => `
                <div class="pill-card">
                    <img src="${p.img}" class="pill-img">
                    <h3 class="text-lg font-black brand-font mb-1">${p.name}</h3>
                    <p class="text-[10px] font-black text-zinc-400 mb-4 uppercase tracking-widest">Premium Blend</p>
                    <div class="flex justify-between items-center bg-zinc-50 p-4 rounded-2xl">
                        <span class="font-black">₹${p.price}</span>
                        <button onclick="addToCart(${p.id})" class="bg-black text-white px-6 py-2 rounded-full text-[10px] font-black uppercase">Add</button>
                    </div>
                </div>
            `).join('');
        }

        document.getElementById('cart-btn').onclick = () => document.getElementById('cart-panel').style.transform = 'translateX(0)';
        renderShop();
    </script>
</body>
</html>

